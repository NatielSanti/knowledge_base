[Заглавная](README.md)

# System example

+ [Whatsapp](system-example.md#Whatsapp)
+ [Netflix и загрузка видео](system-example.md#Netflix-и-загрузка-видео)

[whatsapp]:img/system-example/whatsapp.jpg

[к оглавлению](#System-example)

## Whatsapp

### Основные фичи

1) Групповые сообщения
2) Отправка, доставка, получения вложений
3) Онлайн/Последний раз был в сети
4) Статус сообщений (Отправлено, Доставлено, Прочитано)
5) Хранение истории сообщений
6) One2One chat

### 1) Групповые сообщения
В Whatsapp в группе может быть 200 пользаков (может уже изменилось).
Храним данные о составе групп.
Для рассылки сообщений используются очереди и механизм ретраев. Групповые сообщения посылаются через очередь, 
чтобы не рассылать одно сообщение каждому юзеру от отправителя, а сохранить его и разом отправить всем членам группы.
Очереди нужны для сохранение `очередности`, `идемпотентности` (одно действие всегда срабатывает одинаково), `ретраи`.

### 2) Отправка, доставка, получения вложений
### 3) Онлайн/Последний раз был в сети
Отслеживание последней активности и оповещение сервиса т.е. каждый раз когда клиент делает запрос в гейтвей.
Два типа сообщений - `пользовательские` (пользователь открыл приложение) 
и `фоновые-системные` (приложение запросило новые сообщения).

### 4) Статус сообщений (Отправлено, Доставлено, Прочитано)
Общение посредством `P2P` протокола, такого как `websocket` или `XMPP`.
 - Сообщение отослано в сервис (Отправлено)
 - Сообщение отправлено получателю (Получено)
 - Сообщение прочитано получателем (Прочитано)

### 5) Хранение истории сообщений
### 6) One2One chat

![icon][whatsapp]

[к оглавлению](#System-example)

## Netflix и загрузка видео

- используются разные `кодеки` для разных форматов видео. Более детализированные и менее
- видео разного разрешения
- Целое видео делится на мелкие отрывки по `сценам`. Каждый отрывок делается под разным разрешением и форматом.
- Используется Amazon S3 - удобный для хранения статичных данных, которые не будут изменяться
- Провайдеры хранят часть данных от Нетфликс в своём кеше `Open Connect` своих `ISP`. 
90% трафика нетфликса идёт через провайдера
- Каждое утро в 4 часа ночи кеш ISP может обновляться Нетфликсом

[к оглавлению](#System-example)

[Заглавная](README.md)
