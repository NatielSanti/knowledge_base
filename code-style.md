[Заглавная](README.md)

# Code Style

+ [Creating a project from scratch](#Creating-a-project-from-scratch)
+ [OWASP top 10](#OWASP-top-10)
+ [Работа с Legacy](#Работа-с-Legacy)
+ [Чистый код](#Чистый-код)
+ [New technology implementation](#New-technology-implementation)

[к оглавлению](#Code-Style)

## Creating a project from scratch

First questions
- A project is unique
- A project is dynamic
- A project is based on a management method which is defined in
  the initial planning stages
- A project is always subject to a run time and resources available
- A project seeks a specific objective from the start
- A project is not a routine operation like a process

[ссылка](https://www.sinnaps.com/en/project-management-academy/creating-project-from-scratch)

[к оглавлению](#Code-Style)

## OWASP top 10

В последнем отчете OWASP перечислены 10 основных уязвимостей:

- Инъекции (Injections).
- Нарушенная аутентификация (Broken Authentication).
- Раскрытие критически важных данных (Sensitive Data Exposure).
- Внешние объекты XML (XXE) (XML External Entities (XXE)).
- Нарушенный контроль доступа (Broken Access control).
- Неправильная конфигурация безопасности (Security misconfigurations).
- Межсайтовый скриптинг (XSS) (Cross Site Scripting (XSS)).
- Небезопасная десериализация (Insecure Deserialization).
- Использование компонентов с известными уязвимостями (Using Components with known vulnerabilities).
- Недостаточно подробные журналы и слабый мониторинг (Insufficient logging and monitoring).

[ссылка](https://proglib.io/p/chto-takoe-top-10-owasp-i-kakie-uyazvimosti-veb-prilozheniy-naibolee-opasny-2021-09-09)

[к оглавлению](#Code-Style)

## Работа с Legacy

### Отмазки
- Мы делали “просто” сайт, а теперь вы хотите получить новую “плюшку”, 
и нам нужно все это переписать, так как у нас легаси...
- Никто не знает, как это работает..
- Чтобы добавить модуль, необходимо весь сайт проверить — только так мы поймем, 
что и где может вылезти...
- Я туда не полезу ни в коем случае, там уже все плохо…

### Проблемы по сложности начиная с самой простой

1) Нет техдокументации.
2) Нет бизнес-документации.
3) Нет никого, кто это разрабатывал.
4) Мы не знаем, что должен получить пользователь в конечном итоге.
5) 200+ usage каждой функции и они называются getA.
6) Отсутствуют программисты, которые хотели бы/могли бы разрабатывать.

### Плохие доводы для бизнеса 
- Нанимаем новую команду для качественной “распилки” кода.
- Останавливаем добавление фич, теперь только рефакторинг
- У меня на WP уже все необходимое есть, нужно только базу мигрировать

### Аргументы для переговоров с бизнесом

1) Готов ли бизнес развиваться?
2) Стадия прототипа?
3) Разработка завершена и теперь только поддержка?
4) Хватает ли огня в наших глазах и не потухнет ли он?
5) Есть ли архитектор?

### П — Планирование

Для быстрой и эффективной работы с техническим долгом нужен план.

1. *Определение задач, на которых будем паразитировать.* 
Почему паразитировать? Часто бывает: мы продали фичу, 
а под ней частично подразумеваем рефакторинг.

2. *Определение требований высокого уровня.* 
Необходимо прописать четкий запрос бизнеса по “высокой планке”, 
дабы составить правильную документацию.

3. *Определение основных модулей системы, наложение модулей.* 
Перед стартом рефакторинга, нужно понять основные модули системы: где, как, 
что и с чем может взаимодействовать и разграничивать код на секции.

4. *Определение интеграции.* 
При создании конкретного модуля мы должны заранее продумать возможность 
вмонтировать его в соседний легаси.

5. *Определение команды.* 
Один в поле рефакторинга не воин. 
Команда — очень важный элемент успешного результата. Задор, 
командный драйв и отличное взаимодействие между участниками процесса must have.

6. *Как будем тестить?* 
Если вы собираетесь сдавать качественный проект, 
то нужно заранее продумать и варианты тестирования продукта.
   
### Советы по коду
1. *Не изобретать велосипед.* Для меня это главный лайфхак по написанию кода. 
Уже все придумано до вас, не стоит прибегать к танцам с бубнами и прочим 
экспериментам для решения вопросов с legacy code.

2. *Код стандарт.* Без единого стандарта каждый разработчик будет писать по-своему. 
“Авторский стиль” поспособствует хаосу и нарастит еще больше код-хлама.

3. *Код ревью.* Мало только одного наличия код-стандарта. 
Нужно еще, чтобы в команде был ответственный за его проверку. 
Иначе все вернется на круги своя, то есть к уровню старого кода.

4. *Static Code analyzers, PHP mess detector etc (вместо тысячи книг).* 
Эти и другие автоматические виды техники понадобятся для ускорения процесса, 
в частности с тем же код ревью.

5. *Пробуем микросервисы.* 
Отдельно также могут быть модули или библиотеки. 
Почему именно микросервисы? Их преимущество в максимальной изоляции логики и 
ограничении ее определенным API. Плюсом последней является то, 
что API представляет собой более монолитную сущность по сравнению с 
“адаптером в коде, которым можно поправить”. 
Однако у API есть один недочет в виде дополнительных расходов на сеть.

6. *Архитектура БД, источники данных.* 
Именно базу данных считаю первым “узким” 
местом любого легаси. Но каждый проектирует, как хочет, 
и даже в SQL можно найти неафишируемые недостатки.

7. *Nо SQL?* Если с архитектурной точки зрения вы можете оперировать сущностями 
— оперируйте. Понятие чего-то определённого и конечного поможет вам не создавать 
ненужные, дублирующие релляции.

8. *Декораторы, адаптеры, медиаторы …* Эти паттерны одни из главных для интеграции 
нового кода в старое легаси.

9. *План Б, или план отката при интеграции.* Многие делают ошибку, 
что забывают о нем. Он жизненно необходим в ситуации “когда что-то пойдет не так” 
при заливке нового материала. То есть как только мы начинаем строить архитектуру, 
уже на этом этапе мы должны понимать, как будем откатывать ее назад в случае бага.

10. *Новый код без (доки) тестов через неделю становится легаси.* 
Насколько красивым ни был бы ваш код, без документации через неделю он будет 
в статусе “legacy” — по причине своей непонятности.

11. *Тестирование.* Если юнит-тесты не по карману, то используем смоук, 
функциональные и интеграционные тесты. Насколько реально продать юнит-тесты 
бизнесу под соусом “чтобы сделать работу красиво?”. 
В наших реалиях это скорее редкость, нежели закономерность. 
Если же с “юнитами” по какой-то причине не складывается, то обращаемся к смоук, 
функциональным или интеграционным тестам, а также не забываем, 
что можем делегировать задачу, например, мануальному тестировщику.
   
[ссылка](https://habr.com/ru/post/431562/)

[к оглавлению](#Code-Style)

## New technology implementation

Steps for Implementing Technology in the Workplace
1) Research and Assess the Tech You Need. 
It's always important to research before you buy.
2) Develop an Implementation Blueprint.
3) Consider Assembling an Implementation Team.
4) Map Out the System.
5) Train All Employees.
6) Launch and Monitor the New Technology.

[к оглавлению](#Code-Style)

## Чистый код

1. ***Используйте линтер совместно с IDE*** н-р SonarLint
2. ***Правильный баланс комментариев***
   Объясняйте то, что код делает, а не определяет.
3. ***Автоматизация тестирования***  Unit, integration, e2e
4. ***Обзор кода вручную*** Код ревью
5. ***Quality Gates*** 

### Structural Code Quality characteristics

- **clear** – simple and clean, easy to understand by other
- **easy to maintain** - simple change don’t requires a lot of time 
or code rework
- **follow project guidelines** – allows to ensure consistency between 
developers, updated deliver fast and easier

### Pros of CC

- Easy to edit and understand, save time of devs
- Reduce number of defects
- Project functions properly
- Easier for new developers, reduce onboarding time
- Reduce software development risks and code complexity

### Risks of poor CC

- More time to understand, increase risk of incorrect implementations for devs
- More defects
- More time to implement new features
- Smts need to be rewritten

[к оглавлению](#Code-Style)

[Заглавная](README.md)
